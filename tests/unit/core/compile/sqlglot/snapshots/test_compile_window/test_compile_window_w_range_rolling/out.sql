SELECT
`ts_col` AS `ts_col`,
`int_col` AS `int_col`
FROM
(SELECT
  `t0`.`column_0` AS `ts_col`,
  CASE
    WHEN COALESCE(
      SUM(CAST((
        `t0`.`column_1`
      ) IS NOT NULL AS INT64)) OVER (
        ORDER BY UNIX_MICROS(`t0`.`column_0`) ASC
        RANGE BETWEEN 2999999 preceding AND CURRENT ROW
      ),
      0
    ) < 1
    THEN NULL
    WHEN TRUE
    THEN COALESCE(
      SUM(`t0`.`column_1`) OVER (
        ORDER BY UNIX_MICROS(`t0`.`column_0`) ASC
        RANGE BETWEEN 2999999 preceding AND CURRENT ROW
      ),
      0
    )
    ELSE CAST(NULL AS INT64)
  END AS `int_col`,
  `t0`.`bfuid_col_1527` AS `bfuid_col_1529`
FROM (
  SELECT
    *
  FROM UNNEST(ARRAY<STRUCT<`column_0` TIMESTAMP, `column_1` INT64, `bfuid_col_1527` INT64>>[STRUCT(TIMESTAMP('2025-01-01T00:00:00+00:00'), 0, 0), STRUCT(TIMESTAMP('2025-01-01T00:00:01+00:00'), 1, 1), STRUCT(TIMESTAMP('2025-01-01T00:00:02+00:00'), 2, 2), STRUCT(TIMESTAMP('2025-01-01T00:00:03+00:00'), 3, 3), STRUCT(TIMESTAMP('2025-01-01T00:00:04+00:00'), 0, 4), STRUCT(TIMESTAMP('2025-01-01T00:00:05+00:00'), 1, 5), STRUCT(TIMESTAMP('2025-01-01T00:00:06+00:00'), 2, 6), STRUCT(TIMESTAMP('2025-01-01T00:00:07+00:00'), 3, 7), STRUCT(TIMESTAMP('2025-01-01T00:00:08+00:00'), 0, 8), STRUCT(TIMESTAMP('2025-01-01T00:00:09+00:00'), 1, 9), STRUCT(TIMESTAMP('2025-01-01T00:00:10+00:00'), 2, 10), STRUCT(TIMESTAMP('2025-01-01T00:00:11+00:00'), 3, 11), STRUCT(TIMESTAMP('2025-01-01T00:00:12+00:00'), 0, 12), STRUCT(TIMESTAMP('2025-01-01T00:00:13+00:00'), 1, 13), STRUCT(TIMESTAMP('2025-01-01T00:00:14+00:00'), 2, 14), STRUCT(TIMESTAMP('2025-01-01T00:00:15+00:00'), 3, 15), STRUCT(TIMESTAMP('2025-01-01T00:00:16+00:00'), 0, 16), STRUCT(TIMESTAMP('2025-01-01T00:00:17+00:00'), 1, 17), STRUCT(TIMESTAMP('2025-01-01T00:00:18+00:00'), 2, 18), STRUCT(TIMESTAMP('2025-01-01T00:00:19+00:00'), 3, 19)]) AS `column_0`
) AS `t0`)
ORDER BY `ts_col` ASC NULLS LAST ,`bfuid_col_1529` ASC NULLS LAST