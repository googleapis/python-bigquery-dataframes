WITH `bfcte_0` AS (
  SELECT
    *
  FROM UNNEST(ARRAY<STRUCT<`bfcol_0` TIMESTAMP, `bfcol_1` INT64, `bfcol_2` INT64>>[STRUCT(CAST('2025-01-01T00:00:00+00:00' AS TIMESTAMP), 0, 0), STRUCT(CAST('2025-01-01T00:00:01+00:00' AS TIMESTAMP), 1, 1), STRUCT(CAST('2025-01-01T00:00:02+00:00' AS TIMESTAMP), 2, 2), STRUCT(CAST('2025-01-01T00:00:03+00:00' AS TIMESTAMP), 3, 3), STRUCT(CAST('2025-01-01T00:00:04+00:00' AS TIMESTAMP), 0, 4), STRUCT(CAST('2025-01-01T00:00:05+00:00' AS TIMESTAMP), 1, 5), STRUCT(CAST('2025-01-01T00:00:06+00:00' AS TIMESTAMP), 2, 6), STRUCT(CAST('2025-01-01T00:00:07+00:00' AS TIMESTAMP), 3, 7), STRUCT(CAST('2025-01-01T00:00:08+00:00' AS TIMESTAMP), 0, 8), STRUCT(CAST('2025-01-01T00:00:09+00:00' AS TIMESTAMP), 1, 9), STRUCT(CAST('2025-01-01T00:00:10+00:00' AS TIMESTAMP), 2, 10), STRUCT(CAST('2025-01-01T00:00:11+00:00' AS TIMESTAMP), 3, 11), STRUCT(CAST('2025-01-01T00:00:12+00:00' AS TIMESTAMP), 0, 12), STRUCT(CAST('2025-01-01T00:00:13+00:00' AS TIMESTAMP), 1, 13), STRUCT(CAST('2025-01-01T00:00:14+00:00' AS TIMESTAMP), 2, 14), STRUCT(CAST('2025-01-01T00:00:15+00:00' AS TIMESTAMP), 3, 15), STRUCT(CAST('2025-01-01T00:00:16+00:00' AS TIMESTAMP), 0, 16), STRUCT(CAST('2025-01-01T00:00:17+00:00' AS TIMESTAMP), 1, 17), STRUCT(CAST('2025-01-01T00:00:18+00:00' AS TIMESTAMP), 2, 18), STRUCT(CAST('2025-01-01T00:00:19+00:00' AS TIMESTAMP), 3, 19)])
), `bfcte_1` AS (
  SELECT
    *,
    CASE
      WHEN SUM(CAST(NOT `bfcol_1` IS NULL AS INT64)) OVER (
        ORDER BY UNIX_MICROS(`bfcol_0`) ASC NULLS LAST
        RANGE BETWEEN 2999999 PRECEDING AND CURRENT ROW
      ) < 1
      THEN NULL
      ELSE COALESCE(
        SUM(`bfcol_1`) OVER (
          ORDER BY UNIX_MICROS(`bfcol_0`) ASC NULLS LAST
          RANGE BETWEEN 2999999 PRECEDING AND CURRENT ROW
        ),
        0
      )
    END AS `bfcol_6`
  FROM `bfcte_0`
)
SELECT
  `bfcol_0` AS `ts_col`,
  `bfcol_6` AS `int_col`
FROM `bfcte_1`
ORDER BY
  `bfcol_0` ASC NULLS LAST,
  `bfcol_2` ASC NULLS LAST